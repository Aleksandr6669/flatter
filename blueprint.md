# Blueprint Проекта: Голосовой ассистент с веб-интеграцией

## 1. Обзор проекта

Это приложение представляет собой кастомную домашнюю страницу с голосовым ассистентом. Оно сочетает в себе элегантный дизайн, отображение времени и даты, а также возможность запускать веб-приложения во встроенном WebView. Ключевой особенностью является постоянно доступный оверлей с голосовым ассистентом, который работает как на главном экране, так и поверх открытых веб-страниц.

## 2. Архитектура и дизайн

### 2.1. Структура кода

Код приложения структурирован для улучшения читаемости и поддержки. Ключевые компоненты, такие как `AssistantOverlay`, вынесены в отдельные файлы (`lib/assistant_overlay.dart`), что соответствует принципу разделения ответственностей.

### 2.2. Умная навигация

Для управления навигацией используется комбинация `go_router` и прямого управления `WebViewController`, что обеспечивает максимальную производительность и плавность.

- **Навигация с главного экрана:** При запуске приложения с `WeatherClockScreen` (главного экрана) используется `context.go('/webview')` для первоначального открытия `WebViewScreen`.
- **Навигация внутри WebView:** Если пользователь уже находится на экране `WebViewScreen`, ассистент не пересоздает его. Вместо этого он напрямую использует `WebViewController` для загрузки нового URL. Это делает переключение между сайтами мгновенным и без визуальных сбоев.

### 2.3. Компонент `AssistantOverlay`

`AssistantOverlay` — это виджет, который обеспечивает постоянное присутствие ассистента. Он спроектирован так, чтобы быть контекстно-зависимым:

- **Распознавание речи:** Использует `speech_to_text` для постоянного прослушивания и распознавания ключевого слова "вика".
- **Интерфейс диалога:** Отображает переписку с ассистентом в виде чата.
- **Контекстная навигация:** `AssistantOverlay` может принимать необязательный параметр `WebViewController`. Если этот контроллер предоставлен (как в `WebViewScreen`), ассистент будет использовать его для загрузки URL. В противном случае (как в `WeatherClockScreen`), он будет использовать `context.go` для открытия нового экрана.

#### Голосовые команды

- **"вика, открой Filmix"**: Запускает приложение FilmixTV.
- **"вика, открой Lampa"**: Запускает приложение LampaTV.
- **"вика, открой Lampa STV"**: Запускает приложение LampaSTV.
- **"вика, открой YouTube"**: Запускает приложение YoutubeTV.

### 2.4. Экраны

- **`WeatherClockScreen`:** Главный экран с фоновым изображением, часами, датой и лаунчером приложений. `AssistantOverlay` здесь работает без `WebViewController`.
- **`WebViewScreen`:** Экран, отображающий веб-контент. Он создает `WebViewController` и передает его в `AssistantOverlay`, что позволяет ассистенту напрямую управлять веб-просмотром.

### 2.5. Дизайн

- **Эстетика:** Современный, "стеклянный" дизайн (glassmorphism) с размытым фоном и полупрозрачными элементами.
- **Анимации:** Плавные анимации иконок и переходов для улучшения пользовательского опыта.
- **Типографика:** Четкая и читабельная типографика для отображения времени, даты и сообщений.

## 3. План на будущее

- **Реализовать функцию погоды:** Добавить реальное получение и отображение погоды.
- **Расширить команды ассистента:** Добавить больше команд для управления устройством, поиска информации и т.д.
- **Улучшить обработку ошибок:** Добавить более информативные сообщения об ошибках в `WebView`.
- **Сохранять историю диалога:** Реализовать сохранение истории переписки с ассистентом между сессиями.
